webpackJsonp([2],{"9SxT":function(n,e,t){"use strict";var o={angle:0,currentState:"intro",lineDensity:28,lineWidth:1,smoothSteps:1,mapOpacity:100,heightScale:42,oceanLevel:0,aboutVisible:!1,error:null,zazzleLink:null,generatingPreview:!1,settingsOpen:!1,shouldDraw:!1,renderProgress:null,width:window.innerWidth,height:window.innerHeight,backgroundColor:{r:247,g:242,b:232,a:1},lineBackground:{r:247,g:242,b:232,a:1},lineColor:{r:22,g:22,b:22,a:1}};e.a=o},NHnr:function(n,e,t){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=t("9SxT"),i=t("1e2d"),a=t.n(i),r=t("5dBV"),l=t.n(r);function c(n,e,t){var o=void 0;return i(),{cancel:function(){cancelAnimationFrame(o),n.renderProgress=null},render:i};function i(){n.renderProgress&&(n.renderProgress.message="Rendering...");var i=l()(n.oceanLevel),r=parseFloat(n.smoothSteps);t.style.opacity=n.mapOpacity/100;var c=t.getContext("2d"),h=a(n.lineColor),m=a(n.lineBackground),s=l()(n.lineWidth),d=window.innerHeight,u=window.innerWidth,g=Math.round(d*n.lineDensity/100),f=n.heightScale,w=e.getAllHeightData(),v=w.minHeight,p=w.maxHeight,x=w.rowWithHighestPoint,y=function(n,e,t){var o=Math.round(e/n);return{start:t-Math.floor(t/o)*o,step:o,stop:e}}(g,d,x),H=p-v,b=[],P=y.start;function W(n){if(!(n.length<3)){var e=function(n,e){for(var t=[],o=Number.NEGATIVE_INFINITY,i=Number.POSITIVE_INFINITY,a=n.length/2,r=0;r<a;r+=1){for(var l=r-e,c=l>=0?l:0,h=r+e+1,m=0,s=0,d=c;d<h&&d<a;d+=1)s+=n[2*d+1],m+=1;var u=s/m;t[2*r]=n[2*r],t[2*r+1]=u,o<u&&(o=u),i>u&&(i=u)}return{points:t,min:i,max:o}}(n,r);if(n=e.points,e.max-e.min>2){c.beginPath(),c.fillStyle=m,c.moveTo(n[0],n[1]);for(var t=2;t<n.length;t+=2)c.lineTo(n[t],n[t+1]);c.lineTo(n[n.length-2],e.max),c.lineTo(n[0],e.max),c.closePath(),c.fill()}c.beginPath(),c.strokeStyle=h,c.lineWidth=s,c.moveTo(n[0],n[1]);for(var o=2;o<n.length;o+=2)c.lineTo(n[o],n[o+1]);c.stroke()}}c.beginPath(),c.clearRect(0,0,u,d),c.fillStyle=a(n.backgroundColor),c.fillRect(0,0,u,d),function t(){var a=performance.now();for(var r=P;r<y.stop;r+=y.step){W(b),b=[];for(var l=0;l<window.innerWidth;++l){var c=e.getHeightAtPoint(l,r),h=r-Math.floor(f*(c-v)/H);c<=i?(W(b),b=[]):b.push(l,h)}P=r+y.step;var m=performance.now()-a;if(m>200)return void(o=requestAnimationFrame(t))}W(b);n.renderProgress=null}()}function a(n){return"rgba("+n.r+", "+n.g+", "+n.b+", "+n.a+")"}}var h="pk.eyJ1IjoiYW52YWthIiwiYSI6ImNqaWUzZmhqYzA1OXMza213YXh2ZzdnOWcifQ.t5yext53zn1c9Ixd7Y41Dw",m=t("//Fk"),s=t.n(m),d=t("ifoU"),u="https://api.mapbox.com/v4/mapbox.terrain-rgb/zoom/tLong/tLat@2x.pngraw?access_token="+h,g=new(t.n(d).a);function f(n,e,t){e||(e={});var o=512,i=n.transform.tileZoom,a=Math.pow(2,i),r=n.transform.coveringTiles({minzoom:i,maxzoom:i,tileSize:o}),l=r.reduce(function(n,e){var t=e.canonical;return n.minX>t.x&&(n.minX=t.x),n.minY>t.y&&(n.minY=t.y),n.maxX<t.x&&(n.maxX=t.x),n.maxY<t.y&&(n.maxY=t.y),n},{minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}),c=document.createElement("canvas"),h=l.maxX-l.minX,m=l.maxY-l.minY;if(h>50||m>50)throw new Error("Too many tiles requested. How did you do it?");c.width=h*o+o,c.height=m*o+o;var d=c.getContext("2d"),f=l.minX,w=l.minY;e.total=r.length,y();var v=void 0,p=!1,x=r.map(function(n){var e=function(n){var e=n.canonical;return{url:u.replace("zoom",e.z).replace("tLat",e.y).replace("tLong",e.x),x:o*(e.x-l.minX),y:o*(e.y-l.minY)}}(n);return(t=e.url,i=g.get(t),i||(i=new s.a(function(n,e){var o=new Image;o.onload=function(){n(o)},o.onerror=e,o.crossOrigin="anonymous",o.src=t}),g.set(t,i)),i).then(function(n){d.drawImage(n,e.x,e.y)}).catch(function(){d.beginPath(),d.fillStyle="#0186a0",d.fillRect(e.x,e.y,o,o)}).finally(y);var t,i});return s.a.all(x).then(function(){var e=c.width,t=d.getImageData(0,0,e,c.height).data,i=window.innerWidth,r=window.innerHeight,l=new Float32Array(i*r),h=void 0,m=16,u=1/0,g=-1/0,x=-1,y=0;return v=requestAnimationFrame(function n(){for(var e=window.performance.now(),t=y;t<r;++t){for(var o=0;o<i;++o){var a=t*i+o,c=H(o,t);l[a]=c,c<u&&(u=c),c>g&&(g=c,x=t)}var s=window.performance.now()-e;if(s>m)return void(p||(v=requestAnimationFrame(n)));y=t}window.collectedHeights={minHeight:u,maxHeight:g,rowWithHighestPoint:x,allHeights:l,windowWidth:i,windowHeight:r},console.log({minHeight:u,maxHeight:g,rowWithHighestPoint:x,allHeights:l,windowWidth:i,windowHeight:r}),h({minHeight:u,maxHeight:g,rowWithHighestPoint:x,allHeights:l,windowWidth:i,windowHeight:r})}),new s.a(function(n){h=n});function H(i,r){var l=n.transform.pointLocation({x:i,y:r}),c=function(n,e){return(n+180)/360*e}(l.lng,a),h=(c-f)*o,m=function(n,e){var t=n*Math.PI/180;return(1-Math.log(Math.tan(t)+1/Math.cos(t))/Math.PI)/2*e}(l.lat,a),s=(m-w)*o,d=Math.round(s),u=Math.round(h),g=4*(d*e+u),v=t[g+0],p=t[g+1],x=t[g+2];return function(n,e,t){var o=.1*(256*n*256+256*e+t)-1e4;o<-100&&(o/=5e3);return o}(v,p,x)}}).then(function(n){var e=n.windowWidth,t=n.allHeights;return{getHeightAtPoint:function(n,o){return t[n+o*e]},getAllHeightData:function(){return n}}}).then(function(n){p||t(n)}),{cancel:function(){p=!0,cancelAnimationFrame(v)}};function y(){void 0===e.completed&&(e.completed=-1),e.completed=Math.min(e.total,e.completed+1),e.message="Downloading tiles: "+e.completed+" of "+e.total+"..."}}var w=t("xQT3");t.e(0).then(function(){t("WOBu")}.bind(null,t)).catch(t.oe);var v=void 0,p=void 0,x=void 0;function y(){o.a.zazzleLink=null;var n=document.querySelector(".height-map");n&&(n.style.opacity=.02)}function H(){if(v){var n=document.querySelector(".height-map");n&&(p&&p.cancel(),x&&x.cancel(),o.a.shouldDraw?(n.style.display="",o.a.renderProgress={message:"",isCancelled:!1,completed:!1},x=f(v,o.a.renderProgress,function(e){p=c(o.a,e,n)})):n.style.display="none")}}o.a.init=function(){a.a.accessToken=h,window.map=v=new a.a.Map({trackResize:!0,container:"map",minZoom:0,style:"mapbox://styles/mapbox/light-v10",center:[-118.4432,33.3849],zoom:11.08,hash:!0}),v.addControl(new a.a.NavigationControl({showCompass:!1}),"bottom-right"),v.addControl(new w({accessToken:a.a.accessToken})),v.on("moveend",function(){v.once("idle",H)}),v.on("movestart",y),v.on("load",function(){o.a.angle=v.getBearing()}),v.dragRotate.disable(),v.touchZoomRotate.disableRotation()},o.a.redraw=function(){if(!p)return;p.cancel(),p.render()},o.a.updateMap=H}},["NHnr"]);
//# sourceMappingURL=app.0310b1156f05df3568ae.js.map